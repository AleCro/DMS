import java.util.ArrayList;
import java.util.Collections;
import java.util.List;
import java.util.Random;
import java.util.Scanner;

public class RandomFunFact{
    //Array of predefined fun facts about Florida fish
    private static final String[]FUN_FACTS_ARRAY={
            "Largemouth Bass can live over 16 years in Florida lakes.",
            "Snook can change gender during their life cycle.",
            "Tarpon are nicknamed the 'Silver King' for their shiny scales.",
            "Redfish can live over 50 years and have black tail spots.",
            "Bluegill protect their nests aggressively during spawning.",
            "Florida Gar can breathe air as well as water.",
            "Spotted Seatrout have sharp teeth for catching prey.",
            "Florida Lizardfish is a fast ambush predator in coastal waters.",
            "Sheepshead have human-like teeth for crushing shells.",
            "Pinfish are an important prey for many larger predators.",
            "Mangrove Snapper can be found around Floridaâ€™s mangrove roots.",
            "Florida Pompano is a fast swimmer and popular game fish.",
            "Gulf Flounder lies flat on sandy bottoms to ambush prey.",
            "Florida Sailfin Molly prefers brackish waters.",
            "Mosquito Fish help control mosquito populations naturally.",
            "Florida Killifish is small but resilient in varying habitats.",
            "Black Crappie can be found in freshwater lakes and ponds.",
            "Bowfin are ancient fish species, surviving millions of years.",
            "Sheepshead Minnow is a small schooling fish in estuaries.",
            "Warmouth Bass are aggressive and territorial in Florida waters."
    };

    //Dynamic list of fun facts, allows shuffling and repeated access
    private static final List<String>FUN_FACTS=new ArrayList<>();
    private static int index=0;               //Index to track next fun fact
    private static final Random rand=new Random();//Random generator for shuffling
    private static FishManager manager;        //Reference to FishManager for statistics
    private static Scanner scanner=new Scanner(System.in);//Scanner for user input

    //Initialize the FishManager reference (needed for calculating statistics)
    public static void initialize(FishManager fishManager){
        manager=fishManager;
    }

    //Static block:fill the FUN_FACTS list and shuffle it at startup
    static{
        Collections.addAll(FUN_FACTS, FUN_FACTS_ARRAY);
        Collections.shuffle(FUN_FACTS, rand);
    }
    //------Menu method for user interaction------
    public static void showFunFactMenu(){
        boolean running=true;//Loop control
        while(running){
            System.out.println("\n--- Random Fish Fun Facts ---");
            System.out.println("1. Show a random fun fact");
            System.out.println("2. Show average habitats per fish");
            System.out.println("3. Show the fish with highest ecological diversity");
            System.out.println("~. Go back to main menu");
            System.out.print("Enter choice: ");
            String choice = scanner.nextLine().trim();//Read user input
            switch(choice){
                case"1"://Show a random fun fact
                    System.out.println("\n[Random Fun Fact]");
                    System.out.println(getRandomFact());
                    break;
                case"2":// Show average habitats per fish (requires FishManager)
                    System.out.println("\n[Average Habitats per Fish]");
                    if(manager != null) {
                        double avg = manager.calculateAverageHabitatsPerFish();
                        System.out.printf("Based on your data, the average number of habitats per fish is %.2f!\n", avg);
                    }else{
                        System.out.println("No fish data available. Add some fish first!");
                    }
                    break;
                case"3"://Show fish with highest ecological diversity (requires FishManager)
                    System.out.println("\n[Top Ecological Diversity Fish]");
                    if(manager!=null){
                        String topFish=manager.getTopDiversityFish();
                        System.out.println(topFish);
                    }else{
                        System.out.println("No fish data available. Add some fish first!");
                    }
                    break;
                case"~"://Exit the fun fact menu
                    running=false;
                    break;
                default://Handle invalid input
                    System.out.println("Invalid choice. Please select 1-3 or ~ to go back.");
            }
            //Ask user if they want to continue after each selection
            if(running){
                System.out.print("\nWould you like to pick another fun fact option? (y/n): ");
                if(!scanner.nextLine().trim().equalsIgnoreCase("y")) {
                    running=false;
                }
            }
        }
    }
    //------Get a random fun fact------
    public static String getRandomFact(){
        //If we reach the end of the list, reshuffle and start over
        if(index >= FUN_FACTS.size()) {
            Collections.shuffle(FUN_FACTS, rand);
            index = 0;
        }
        //Return the next fact and increment index
        String fact=FUN_FACTS.get(index);
        index++;
        return fact;
    }
}
